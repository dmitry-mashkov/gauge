var Gauge;!function(a){a.CSSClasses={Gauge:"g-gauge",Canvas:"g-canvas",Pointer:"g-pointer",Sector:"g-sector",Label:"g-label"}}(Gauge||(Gauge={}));var Gauge;!function(Gauge){var Size=function(){function Size(a,b){"undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=0),this.Width=a,this.Height=b}return Size}();Gauge.Size=Size}(Gauge||(Gauge={}));var Gauge;!function(Gauge){Gauge.SVGHelper={PolarToCartesian:function(a,b,c,d){var e=(d-90)*Math.PI/180;return{x:a+c*Math.cos(e),y:b+c*Math.sin(e)}},DescribeArc:function(a,b,c,d,e){var f=Gauge.SVGHelper.PolarToCartesian(a,b,c,e),g=Gauge.SVGHelper.PolarToCartesian(a,b,c,d),h=e-d<=180?"0":"1",i=["M",f.x,f.y,"A",c,c,0,h,0,g.x,g.y].join(" ");return i},GetTextMetric:function(a){"undefined"==typeof a&&(a="W");var b=!1;""===a&&(a="W",b=!0);var c=document.createElement("span");c.style.display="inline-block",c.style.lineHeight="1",c.innerHTML=a;var d=document.getElementsByTagName("body")[0];d.appendChild(c);var e=new Gauge.Size(c.offsetWidth,c.offsetHeight);return b&&(e.Width=Math.round(.8*e.Width)),d.removeChild(c),e}}}(Gauge||(Gauge={}));var Gauge;!function(Gauge){var a=function(){function a(a,b){if(this.color=null,a<=0||a>100)throw new Error("Width of a sector must be valid percentage.");this.percentage=a,b&&(this.color=b)}return Object.defineProperty(a.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Percentage",{get:function(){return this.percentage},enumerable:!0,configurable:!0}),a}();Gauge.Sector=a}(Gauge||(Gauge={}));var Gauge;!function(a){var Gauge=function(){function Gauge(){this.targetElement=null,this.gaugeElement=null,this.canvasElement=null,this.labelsOutside=!0,this.canvasSize=new a.Size(450,450),this.value=0,this.labels=["0","1","2","3","4","5","6"],this.sectors=null,this.availableDegrees=260,this._svgCanvas=null,this._pointerElement=null,this.sectors=[new a.Sector(70),new a.Sector(20),new a.Sector(10)],this.Value=65}return Object.defineProperty(Gauge.prototype,"LabelsOutside",{get:function(){return this.labelsOutside},set:function(a){this.labelsOutside!==a&&(this.labelsOutside=a,this.redrawCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"scaleRadius",{get:function(){return.9*Math.min(this.canvasSize.Width,this.canvasSize.Height)/2},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"CanvasSize",{get:function(){return this.canvasSize},set:function(a){a.Width!==this.canvasSize.Width&&a.Height!==this.canvasSize.Height&&(this.canvasSize=a,this.redrawCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"Value",{get:function(){return this.value},set:function(a){a!==this.value&&a>=0&&a<=100&&(this.value=a,this.redrawCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"Labels",{get:function(){return this.labels},set:function(a){this.labels=a,this.redrawCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"Sectors",{get:function(){return this.sectors},set:function(a){var b=0;for(var c in a)if(b+=a[c].Percentage,b>100)throw new Error("The entire sectors width must not be more than 100%.");this.sectors=a,this.redrawCanvas()},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"AvailableDegrees",{get:function(){return this.availableDegrees},set:function(a){this.availableDegrees!==a&&(this.availableDegrees=a,this.redrawCanvas())},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"svgCanvas",{get:function(){return null===this._svgCanvas&&(this._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svgCanvas.setAttribute("width",this.canvasSize.Width+""),this._svgCanvas.setAttribute("height",this.canvasSize.Height+"")),this._svgCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(Gauge.prototype,"pointerElement",{get:function(){return null===this._pointerElement&&(this._pointerElement=document.createElementNS("http://www.w3.org/2000/svg","path"),this._pointerElement.setAttribute("class",a.CSSClasses.Pointer)),this._pointerElement},enumerable:!0,configurable:!0}),Gauge.prototype.Init=function(b){if(this.targetElement=b,null===this.targetElement||!(this.targetElement instanceof HTMLElement))throw new Error("Target HTML element not specified.");this.gaugeElement=document.createElement("div"),this.gaugeElement.classList.add(a.CSSClasses.Gauge),this.canvasElement=document.createElement("div"),this.canvasElement.className=a.CSSClasses.Canvas,this.gaugeElement.appendChild(this.canvasElement),this.targetElement.appendChild(this.gaugeElement),this.redrawCanvas()},Gauge.prototype.redrawCanvas=function(b){if("undefined"==typeof b&&(b=!1),b||null!==this.canvasElement){for(;this.canvasElement.firstChild;)this.canvasElement.removeChild(this.canvasElement.firstChild);var c=360-this.availableDegrees/2,d=this.canvasSize.Width/2,e=this.canvasSize.Height/2,f=0;for(var g in this.sectors){var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("class",a.CSSClasses.Sector);var i=c+this.AvailableDegrees*f/100;i>360&&(i-=360);var j=i+this.AvailableDegrees*this.sectors[g].Percentage/100;j>360&&(j-=360),h.setAttribute("d",a.SVGHelper.DescribeArc(d,e,this.scaleRadius,i,j)),this.sectors[g].Color&&(h.style.stroke=this.sectors[g].Color),this.svgCanvas.appendChild(h),f+=this.sectors[g].Percentage}for(var g in this.labels){var k=360-this.availableDegrees/2+this.availableDegrees/(this.labels.length-1)*g;k>360&&(k-=360);var l=this.labelsOutside?15:-15,m=a.SVGHelper.PolarToCartesian(d,e,this.scaleRadius+l,k),n=a.SVGHelper.GetTextMetric(this.labels[g]),o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("class",a.CSSClasses.Label),o.setAttribute("x",m.x-n.Width/2+""),o.setAttribute("y",m.y+n.Height/2+""),o.textContent=this.labels[g],this.svgCanvas.appendChild(o)}this.canvasElement.appendChild(this.svgCanvas),this.redrawPointer()}},Gauge.prototype.redrawPointer=function(){var b=this.canvasSize.Width/2,c=this.canvasSize.Height/2,d=this.pointerElement,e=this.availableDegrees*this.value/100,f=360-this.availableDegrees/2+e;f>360&&(f-=360);var g=a.SVGHelper.PolarToCartesian(b,c,this.scaleRadius+5,f),h=f+30;h>360&&(h-=360),h-=360,d.setAttribute("d",a.SVGHelper.DescribeArc(b,c,10,h,f-30)+" L "+g.x+" "+g.y+" Z"),this.svgCanvas.appendChild(d)},Gauge}();a.Gauge=Gauge}(Gauge||(Gauge={}));